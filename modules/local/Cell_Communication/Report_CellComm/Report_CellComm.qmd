---
title: "SCRATCH Cell Communication Report"
author: "Syed Shujaat Ali Zaidi"
execute:
  freeze: auto
  cache: false
  warning: false
format:
  html:
    toc: true
    toc-location: right
    toc-depth: 2
    embed-resources: true
    code-fold: true
    code-tools: true
    fig-format: png
    fig-dpi: 300
params:
  project_name: "project"
  work_directory: "."
---

```{r}
suppressPackageStartupMessages({
  library(readr)
  library(dplyr)
  library(knitr)
})
if (!is.null(params$work_directory) && dir.exists(params$work_directory)) {
  setwd(params$work_directory)
}
```
```{r}
if (file.exists("data/liana_results.csv")) {
liana_res <- read_csv("data/liana_results.csv", show_col_types = FALSE)
cat("LIANA interactions:", nrow(liana_res), "\n")
} else {
cat("No LIANA results found.\n")
}
```

```{r}
figs <- c(
"figures/cellcomm/liana/celltype_counts_filtered.png",
"figures/cellcomm/liana/liana_topLR_dotplot.png",
"figures/cellcomm/liana/liana_edgecount_heatmap.png"
)
for (f in figs) if (file.exists(f)) knitr::include_graphics(f)
```

```{r}
if (file.exists("data/cellchat_communications.csv")) {
cc <- read_csv("data/cellchat_communications.csv", show_col_types = FALSE)
cat("CellChat communications:", nrow(cc), "\n")
} else {
cat("No CellChat communications found.\n")
}
```

```{r}
figs <- c(
"figures/cellcomm/cellchat/cellchat_circle_count.png",
"figures/cellcomm/cellchat/cellchat_circle_weight.png",
"figures/cellcomm/cellchat/cellchat_pathway_heatmap.png",
"figures/cellcomm/cellchat/cellchat_pathway_rank.png"
)
for (f in figs) if (file.exists(f)) knitr::include_graphics(f)

```


```{r}
if (file.exists("data/nichenet_summary.csv")) {
nn <- read_csv("data/nichenet_summary.csv", show_col_types = FALSE)
knitr::kable(nn)
} else {
cat("No NicheNet summary found.\n")
}
```

```{r}
if (file.exists("figures/cellcomm/nichenet/auto_receiver_ranking.png")) {
knitr::include_graphics("figures/cellcomm/nichenet/auto_receiver_ranking.png")
}

if (dir.exists("figures/cellcomm/nichenet")) {
rec_dirs <- list.dirs("figures/cellcomm/nichenet", recursive = FALSE, full.names = TRUE)
rec_dirs <- rec_dirs[grepl("receiver_", basename(rec_dirs))]
for (rd in rec_dirs) {
cat("\n### ", basename(rd), "\n\n")
for (f in c("top_ligands.png","ligand_target_heatmap.png")) {
fp <- file.path(rd, f)
if (file.exists(fp)) knitr::include_graphics(fp)
}
}
}
```

```{r}
sessionInfo()
```


